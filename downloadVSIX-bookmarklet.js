javascript:(function(){'use strict';const c={selectors:{metadata:['.ux-table-metadata tr','.metadata-table tr'],container:['.ms-Fabric.root-38','.vscode-moreinformation','.extension-details','main']},urls:{vsix:'https://${p}.gallery.vsassets.io/_apis/public/gallery/publisher/${p}/extension/${e}/${v}/assetbyname/Microsoft.VisualStudio.Services.VSIXPackage',pkg:'https://marketplace.visualstudio.com/_apis/public/gallery/publishers/${p}/vsextensions/${e}/${v}/vspackage'}};const u={find(s){for(const sel of s){const el=document.querySelector(sel);if(el)return el}return null},notify(m,t='info'){const n=document.createElement('div');const colors={success:'#2ecc71',error:'#e74c3c',info:'#3498db'};Object.assign(n.style,{position:'fixed',top:'20px',right:'20px',padding:'16px 24px',background:colors[t],color:'white',borderRadius:'8px',boxShadow:'0 4px 12px rgba(0,0,0,0.2)',zIndex:'10000',fontFamily:'Segoe UI,sans-serif',fontSize:'14px',fontWeight:'500',maxWidth:'400px'});n.textContent=m;document.body.appendChild(n);setTimeout(()=>n.remove(),3000)},async copy(txt){try{await navigator.clipboard.writeText(txt);this.notify('âœ“ Copied!','success');return true}catch(e){return false}}};class Ext{constructor(){this.data={version:'',publisher:'',identifier:''}}extract(){const map={'Version':'version','Publisher':'publisher','Unique Identifier':'identifier'};const table=u.find(c.selectors.metadata.map(s=>s.replace(' tr','')));if(!table)throw new Error('Metadata not found');table.querySelectorAll('tr').forEach(row=>{const cells=row.querySelectorAll('td');if(cells.length>=2){const k=cells[0].innerText.trim();const v=cells[1].innerText.trim();if(map[k])this.data[map[k]]=v}});if(!this.data.identifier){const params=new URLSearchParams(window.location.search);this.data.identifier=params.get('itemName')||''}if(!this.data.version||!this.data.identifier)throw new Error('Missing data');return this.data}getUrl(type='vsix'){const[p,e]=this.data.identifier.split('.');const tmpl=type==='pkg'?c.urls.pkg:c.urls.vsix;return tmpl.replace(/\$\{p\}/g,p).replace(/\$\{e\}/g,e).replace(/\$\{v\}/g,this.data.version)}download(type='vsix'){const url=this.getUrl(type);const fn=`${this.data.identifier}_${this.data.version}.${type==='pkg'?'vsixpackage':'vsix'}`;u.notify(`â¬‡ Downloading...`,'info');const a=document.createElement('a');a.href=url;a.download=fn;a.click();setTimeout(()=>u.notify(`âœ“ Started: ${fn}`,'success'),500)}}class UI{constructor(ext){this.ext=ext}btn(txt,icon,onClick,v='p'){const b=document.createElement('button');b.innerHTML=`${icon} ${txt}`;Object.assign(b.style,{fontFamily:'Segoe UI,sans-serif',display:'inline-flex',alignItems:'center',gap:'8px',padding:'12px 24px',background:v==='p'?'linear-gradient(135deg,#2ecc71,#27ae60)':'linear-gradient(135deg,#3498db,#2980b9)',color:'white',fontWeight:'600',fontSize:'15px',margin:'8px 5px',border:'none',borderRadius:'8px',cursor:'pointer',transition:'all 0.3s',boxShadow:'0 4px 12px rgba(0,0,0,0.2)'});b.onmouseenter=()=>{b.style.transform='translateY(-2px)';b.style.boxShadow='0 6px 16px rgba(0,0,0,0.3)'};b.onmouseleave=()=>{b.style.transform='translateY(0)';b.style.boxShadow='0 4px 12px rgba(0,0,0,0.2)'};b.onclick=onClick;return b}render(){if(document.getElementById('vsix-dl'))return;const target=u.find(c.selectors.container);if(!target)throw new Error('Container not found');const div=document.createElement('div');div.id='vsix-dl';Object.assign(div.style,{display:'flex',flexWrap:'wrap',gap:'10px',margin:'16px 0',padding:'16px',background:'rgba(255,255,255,0.05)',borderRadius:'12px',border:'1px solid rgba(255,255,255,0.1)'});div.appendChild(this.btn('Download VSIX','ðŸ“¦',()=>this.ext.download('vsix'),'p'));div.appendChild(this.btn('Copy URL','ðŸ“‹',()=>u.copy(this.ext.getUrl('vsix')),'s'));div.appendChild(this.btn('Download Pkg','ðŸ“¥',()=>this.ext.download('pkg'),'s'));target.parentNode.insertBefore(div,target.nextSibling);u.notify('âœ“ Loaded!','success')}}function init(){try{const style=document.createElement('style');document.head.appendChild(style);const ext=new Ext();ext.extract();const ui=new UI(ext);ui.render()}catch(e){u.notify(`âœ— ${e.message}`,'error')}}if(document.readyState==='loading'){document.addEventListener('DOMContentLoaded',init)}else{init()}})();